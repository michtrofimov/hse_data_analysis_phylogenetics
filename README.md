# Лекция/Семинар 6. Филогенетика 

Мичил Трофимов 15/10/2024

> Сохраняйте результаты всех выполненных заданий, в конце их необходимо объединить в репорт


### Расположение файлов

Файлы для этого задания находятся в этом репозитории github в папке /data/: 

https://github.com/michtrofimov/hse_data_analysis_phylogenetics

Чтобы скачать файл с github, есть 2 варианта:

a) щелкните правой кнопкой мыши по кнопке `Raw` в верхней части файла, выберите `Save Link As...` (или, в зависимости от версии вашего интернет-браузера, `Download Linked File As...`), выберите место на вашем компьютере, куда вы хотите сохранить файл, и выберите `Save`. 

б) нажмите `Raw` в окне GitHub с файлом, скопируйте ссылку из браузера и используйте `wget` для загрузки, как в примере ниже: 

```
wget https://github.com/michtrofimov/hse_data_analysis_MSA/blob/master/data/upstreams.fasta
```




### Задание 1. Нарисовать дерево

Нарисуйте дерево в любом удобном графическом редакторе или на бумаге.

 (((a,b),(d,e)),c);

### Задание 2. Анализ существующих деревьев

1. Зайдите на сайт PubMed: https://pubmed.ncbi.nlm.nih.gov/.
2. Найдите любую статью, которая может быть источником уже построенного дерева. Укажите DOI
или ссылку на запись/статью в PubMed.
3. Сообщите (а) какая таксономическая группа была проанализирована в статье и (б) какой метод был использован для построения дерева в статье.
какой метод был использован для построения дерева в статье.
4. Опишите дерево: ультраметрическое или не ультраметрическое; укорененное или неукорененное.

### Задание 3. Генерация филогенетического древа белка в программе MEGA

1. Получите FASTA-файл белка (data/sample_prot.fasta).
2. Постройте дерево в MEGA с помощью алгоритма NJ.
3. Сохраните рисунок в формате PNG.
4. Сохраните дерево в формате Newick.

### Задание 4. Полный процесс получения дерева от .fasta --> png/newick

1. Получите нуклеотидный FASTA-файл (data/sample_nucl.fasta).
2. Постройте выравнивание в CLUSTALW (https://www.ebi.ac.uk/Tools/msa/muscle/)
   - обязательно отметьте что у вас нуклеотидная последовательность
   - сохраните множественное выравнивание в формате .fasta
4. Постройте дерево в MEGA с помощью алгоритма ML со 100 бутстрапами.
5. Сохраните рисунок ML-дерева (в PNG) и дерево (в Newick).
6. Сохраните рисунок бутстрапного дерева (в PNG).
7. Постройте дерево в MEGA, используя алгоритм NJ.
8. Сохраните рисунок в формате PNG.
9. Сохраните дерево в формате Newick.
10. Сравните полученное дерево NJ с ранее полученным деревом ML и с деревом
полученным в задании 3.

> Сравнивая деревья, помните, что они не являются корневыми!

### Задание 5. Альтернативная визуализация деревьев

- Зайдите на сервер iTOL: https://itol.embl.de/.
- Загрузите дерево (data/sample_tree.nwk).
- Внесите следующие изменения:
1. Круговое дерево
2. Курсив для имен листьев
3. Укорените дерево в средней точке
4. Свернуть любой узел
5. Окрасьте любой клайд в красный цвет
6. Загрузите рисунок в формате PNG

На английском:
1. Circular tree
2. Italic for leaf names
3. Root the tree to the midpoint
4. Collapse any node
5. Colorize any clade by red
6. Download the figure in PNG format

### Задание 6. 

1. После выполнения заданий 3 и 4 у вас должно быть 3 файла Newick. Поместите их вместе в какую-нибудь папку.
В командной строке введите команду, которая подсчитает количество символов во всех файлах Newick в папке.
Включите в отчет скриншот с командой и ее выводом.
2. Теперь введите команду, которая объединяет эти 3 файла Newick, а затем подсчитывает
количество символов в конкатенированном файле (без сохранения
конкатенированного файла!). Включите скриншот экрана с командой и ее выводом в свой
отчет.
3. Ответьте на вопрос: равно ли количество символов в конкатенированном файле по сравнению с первым подзаданием (подсчетом всех символов во всех Newick файлах)?


### Домашнее задание

Выполните все задания (1-6), напишите отчет, сохраните его в формате PDF.
В отчете укажите:
Задание 1 (0,5 балла).
1. Изображение получившегося дерева (нарисованное в Paint, или фотография дерева, нарисованная на бумаге) (0,5 балла).
Задание 2 (2 балла).
1. Ссылка на работу (0,25 балла).
2. Таксономическая группа, анализируемая в работе, и метод, использованный для реконструкции дерева (1 балл).
3. Краткое описание дерева (масштабированное или нет, укорененное или нет) (0,75 балла).
Задание 3 (0,5 балла).
1. Изображение дерева NJ вместе с деревом Ньюика в тексте (0,5 балла).

Выполните все задания из презентации (1-6), напишите отчет, сохраните его в формате PDF и загрузите на Canvas.
Укажите в отчете:
Задание 1 (0,5 балла).
1. рисунок получившегося дерева (нарисованный в Paint или фотография дерева, нарисованная на бумаге) (0,5 балла).
Задание 2 (2 балла).
1. Ссылка на работу (0,25 балла).
2. Таксономическая группа, анализируемая в работе, и метод, использованный для реконструкции дерева (1 балл).
3. Краткое описание дерева (масштабированное или нет, укорененное или нет) (0,75 балла).
Задание 3 (0,5 балла).
1. Изображение дерева NJ вместе с деревом Т в тексте (0,5 балла).
Задание 4 (4 балла).
1. Изображение дерева NJ вместе с деревом Newick в тексте (0,5 балла).
2. Изображение ML-дерева с поддержкой бутстрапа вместе с деревом Ньюика в тексте (0,5 балла).
3. Ваши наблюдения о различиях (если таковые имеются) между деревьями NJ и ML. Появляются ли листья в
Появляются ли листья в различных кладах на этих деревьях? Что могут сказать нам значения бутстрапа? Каково возможное объяснение
различий (если они есть)? (1,5 балла).
4. Ваши наблюдения о различиях (если таковые имеются) между деревьями, полученными на основе нуклеотидных и белковых последовательностей.
последовательностей. Какое дерево имеет лучшее разрешение на нашем наборе данных? Чем это можно объяснить? (1.5
баллов).
Задание 5 (2 балла).
1. Приведите результирующую цифру из iTOL (2 балла).
Задание 6 (1 балл).
1. Задание командной строки: приведите скриншоты и ответьте на вопрос (1 балл).
